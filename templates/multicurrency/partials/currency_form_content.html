{% load i18n djicons %}
<div data-back-url="{% url 'multicurrency:currencies' %}" hidden></div>

<div class="max-w-lg mx-auto space-y-4">

    <div class="flex items-center gap-2">
        <h2 class="text-xl font-semibold">
            {% if currency %}
                {% trans "Edit Currency" %}: {{ currency.code }}
            {% else %}
                {% trans "New Currency" %}
            {% endif %}
        </h2>
    </div>

    <div class="card">
        <div class="card-body" x-data="currencyForm()">
            <form @submit.prevent="submitForm($el)"
                  hx-post="{% if currency %}{% url 'multicurrency:currency_edit' currency.pk %}{% else %}{% url 'multicurrency:currency_create' %}{% endif %}"
                  hx-headers='{"X-CSRFToken": "{{ csrf_token }}"}'
                  hx-swap="none">

                <div class="form-group">
                    <label class="form-group-label" for="id_code">{% trans "Currency Code" %}</label>
                    {{ form.code }}
                    <p class="text-xs opacity-60 mt-1">{% trans "ISO 4217 code (e.g. USD, GBP, JPY)" %}</p>
                    {% if form.code.errors %}
                        <p class="text-sm color-error mt-1">{{ form.code.errors.0 }}</p>
                    {% endif %}
                </div>

                <div class="form-group">
                    <label class="form-group-label" for="id_name">{% trans "Name" %}</label>
                    {{ form.name }}
                    {% if form.name.errors %}
                        <p class="text-sm color-error mt-1">{{ form.name.errors.0 }}</p>
                    {% endif %}
                </div>

                <div class="form-group">
                    <label class="form-group-label" for="id_symbol">{% trans "Symbol" %}</label>
                    {{ form.symbol }}
                    {% if form.symbol.errors %}
                        <p class="text-sm color-error mt-1">{{ form.symbol.errors.0 }}</p>
                    {% endif %}
                </div>

                <div class="form-group">
                    <label class="form-group-label" for="id_exchange_rate">{% trans "Exchange Rate" %}</label>
                    {{ form.exchange_rate }}
                    <p class="text-xs opacity-60 mt-1">{% trans "Rate relative to base currency" %}</p>
                    {% if form.exchange_rate.errors %}
                        <p class="text-sm color-error mt-1">{{ form.exchange_rate.errors.0 }}</p>
                    {% endif %}
                </div>

                <div class="form-group">
                    <label class="form-group-label" for="id_decimal_places">{% trans "Decimal Places" %}</label>
                    {{ form.decimal_places }}
                    {% if form.decimal_places.errors %}
                        <p class="text-sm color-error mt-1">{{ form.decimal_places.errors.0 }}</p>
                    {% endif %}
                </div>

                <div class="form-group">
                    <label class="form-group-label" for="id_sort_order">{% trans "Sort Order" %}</label>
                    {{ form.sort_order }}
                </div>

                <div class="form-group flex items-center justify-between">
                    <label class="form-group-label" for="id_is_active">{% trans "Active" %}</label>
                    {{ form.is_active }}
                </div>

                <div class="flex gap-2 mt-6">
                    <button type="button" class="btn flex-1"
                            hx-get="{% url 'multicurrency:currencies' %}"
                            hx-target="#main-content-area"
                            hx-push-url="true">
                        {% trans "Cancel" %}
                    </button>
                    <button type="submit" class="btn color-primary flex-1">
                        {% icon "save-outline" %}
                        {% if currency %}{% trans "Update" %}{% else %}{% trans "Create" %}{% endif %}
                    </button>
                </div>
            </form>
        </div>
    </div>

</div>

<script>
function currencyForm() {
    return {
        submitForm(form) {
            // Let HTMX handle submission
        }
    }
}
</script>
