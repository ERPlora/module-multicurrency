{% load i18n djicons %}

<div class="space-y-4">

    <!-- Header -->
    <div class="flex items-center justify-between flex-wrap gap-2">
        <h2 class="text-xl font-semibold">{% trans "Rate History" %}</h2>

        <!-- Currency Filter -->
        <div class="flex items-center gap-2">
            <select class="select"
                    hx-get="{% url 'multicurrency:history' %}"
                    hx-target="#main-content-area"
                    hx-push-url="true"
                    name="currency">
                <option value="">{% trans "All Currencies" %}</option>
                {% for code in available_currencies %}
                <option value="{{ code }}" {% if code == currency_filter %}selected{% endif %}>{{ code }}</option>
                {% endfor %}
            </select>
        </div>
    </div>

    <!-- History Table -->
    {% if history %}
    <div class="card">
        <div class="overflow-x-auto">
            <table class="table">
                <thead>
                    <tr>
                        <th>{% trans "Date" %}</th>
                        <th>{% trans "Currency" %}</th>
                        <th class="text-right">{% trans "Rate" %}</th>
                        <th>{% trans "Source" %}</th>
                    </tr>
                </thead>
                <tbody>
                    {% for entry in history %}
                    <tr>
                        <td class="text-sm">{{ entry.recorded_at|date:"d/m/Y H:i:s" }}</td>
                        <td>
                            <span class="font-semibold">{{ entry.currency.code }}</span>
                            <span class="text-sm opacity-70 ml-1">{{ entry.currency.name }}</span>
                        </td>
                        <td class="text-right font-mono">{{ entry.rate }}</td>
                        <td>
                            {% if entry.source == 'manual' %}
                                <span class="badge">{% trans "Manual" %}</span>
                            {% elif entry.source == 'ecb' %}
                                <span class="badge color-primary">ECB</span>
                            {% elif entry.source == 'exchangerate_api' %}
                                <span class="badge color-primary">API</span>
                            {% else %}
                                <span class="badge">{{ entry.source }}</span>
                            {% endif %}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
    {% else %}
    <div class="card">
        <div class="card-body text-center py-8">
            {% icon "time-outline" css_class="text-4xl opacity-30 mb-2" %}
            <p class="opacity-70">{% trans "No rate history available." %}</p>
        </div>
    </div>
    {% endif %}

</div>
